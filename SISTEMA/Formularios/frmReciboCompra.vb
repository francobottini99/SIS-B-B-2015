Public Class frmReciboCompra
    Private Sub btnNuevo_GotFocus(sender As Object, e As EventArgs) Handles btnNuevo.GotFocus
        btnNuevo.BackgroundImage = ByB_SI.My.Resources.NuevoAc
    End Sub

    Private Sub btnNuevo_LostFocus(sender As Object, e As EventArgs) Handles btnNuevo.LostFocus
        btnNuevo.BackgroundImage = ByB_SI.My.Resources.NuevoIn
    End Sub

    Private Sub btnNuevo_MouseEnter(sender As Object, e As EventArgs) Handles btnNuevo.MouseEnter
        btnNuevo.BackgroundImage = ByB_SI.My.Resources.NuevoAc
    End Sub

    Private Sub btnNuevo_MouseLeave(sender As Object, e As EventArgs) Handles btnNuevo.MouseLeave
        btnNuevo.BackgroundImage = ByB_SI.My.Resources.NuevoIn
    End Sub

    Private Sub btnGuardar_GotFocus(sender As Object, e As EventArgs) Handles btnGuardar.GotFocus
        btnGuardar.BackgroundImage = ByB_SI.My.Resources.GuardarAc
    End Sub

    Private Sub btnGuardar_LostFocus(sender As Object, e As EventArgs) Handles btnGuardar.LostFocus
        btnGuardar.BackgroundImage = ByB_SI.My.Resources.GuardarIn
    End Sub

    Private Sub btnGuardar_MouseEnter(sender As Object, e As EventArgs) Handles btnGuardar.MouseEnter
        btnGuardar.BackgroundImage = ByB_SI.My.Resources.GuardarAc
    End Sub

    Private Sub btnGuardar_MouseLeave(sender As Object, e As EventArgs) Handles btnGuardar.MouseLeave
        btnGuardar.BackgroundImage = ByB_SI.My.Resources.GuardarIn
    End Sub

    Private Sub btnCancelar_GotFocus(sender As Object, e As EventArgs) Handles btnCancelar.GotFocus
        btnCancelar.BackgroundImage = ByB_SI.My.Resources.CancelarAc
    End Sub

    Private Sub btnCancelar_LostFocus(sender As Object, e As EventArgs) Handles btnCancelar.LostFocus
        btnCancelar.BackgroundImage = ByB_SI.My.Resources.CancelarIn
    End Sub

    Private Sub btnCancelar_MouseEnter(sender As Object, e As EventArgs) Handles btnCancelar.MouseEnter
        btnCancelar.BackgroundImage = ByB_SI.My.Resources.CancelarAc
    End Sub

    Private Sub btnCancelar_MouseLeave(sender As Object, e As EventArgs) Handles btnCancelar.MouseLeave
        btnCancelar.BackgroundImage = ByB_SI.My.Resources.CancelarIn
    End Sub

    Private Sub btnSalir_GotFocus(sender As Object, e As EventArgs) Handles btnSalir.GotFocus
        btnSalir.BackgroundImage = ByB_SI.My.Resources.SalirAc
    End Sub

    Private Sub btnSalir_LostFocus(sender As Object, e As EventArgs) Handles btnSalir.LostFocus
        btnSalir.BackgroundImage = ByB_SI.My.Resources.SalirIn
    End Sub

    Private Sub btnSalir_MouseEnter(sender As Object, e As EventArgs) Handles btnSalir.MouseEnter
        btnSalir.BackgroundImage = ByB_SI.My.Resources.SalirAc
    End Sub

    Private Sub btnSalir_MouseLeave(sender As Object, e As EventArgs) Handles btnSalir.MouseLeave
        btnSalir.BackgroundImage = ByB_SI.My.Resources.SalirIn
    End Sub

    Private Sub btnEliminar_GotFocus(sender As Object, e As EventArgs) Handles btnEliminarValor.GotFocus
        btnEliminarValor.BackgroundImage = ByB_SI.My.Resources.EliminarAc
    End Sub

    Private Sub btnEliminar_LostFocus(sender As Object, e As EventArgs) Handles btnEliminarValor.LostFocus
        btnEliminarValor.BackgroundImage = ByB_SI.My.Resources.EliminarIn
    End Sub

    Private Sub btnEliminar_MouseEnter(sender As Object, e As EventArgs) Handles btnEliminarValor.MouseEnter
        btnEliminarValor.BackgroundImage = ByB_SI.My.Resources.EliminarAc
    End Sub

    Private Sub btnEliminar_MouseLeave(sender As Object, e As EventArgs) Handles btnEliminarValor.MouseLeave
        btnEliminarValor.BackgroundImage = ByB_SI.My.Resources.EliminarIn
    End Sub

    Private Sub btnCargarValor_GotFocus(sender As Object, e As EventArgs) Handles btnCargarValor.GotFocus
        btnCargarValor.BackgroundImage = ByB_SI.My.Resources.IngresoAc
    End Sub

    Private Sub btnCargarValor_LostFocus(sender As Object, e As EventArgs) Handles btnCargarValor.LostFocus
        btnCargarValor.BackgroundImage = ByB_SI.My.Resources.IngresoIn
    End Sub

    Private Sub btnCargarValor_MouseEnter(sender As Object, e As EventArgs) Handles btnCargarValor.MouseEnter
        btnCargarValor.BackgroundImage = ByB_SI.My.Resources.IngresoAc
    End Sub

    Private Sub btnCargarValor_MouseLeave(sender As Object, e As EventArgs) Handles btnCargarValor.MouseLeave
        btnCargarValor.BackgroundImage = ByB_SI.My.Resources.IngresoIn
    End Sub

    Private Sub btnModValor_GotFocus(sender As Object, e As EventArgs) Handles btnModValor.GotFocus
        btnModValor.BackgroundImage = ByB_SI.My.Resources.ModifAc
    End Sub

    Private Sub btnModValor_LostFocus(sender As Object, e As EventArgs) Handles btnModValor.LostFocus
        btnModValor.BackgroundImage = ByB_SI.My.Resources.ModifIn
    End Sub

    Private Sub btnModValor_MouseEnter(sender As Object, e As EventArgs) Handles btnModValor.MouseEnter
        btnModValor.BackgroundImage = ByB_SI.My.Resources.ModifAc
    End Sub

    Private Sub btnModValor_MouseLeave(sender As Object, e As EventArgs) Handles btnModValor.MouseLeave
        btnModValor.BackgroundImage = ByB_SI.My.Resources.ModifIn
    End Sub

    Private Sub btnCancelarValor_GotFocus(sender As Object, e As EventArgs) Handles btnCancelarValor.GotFocus
        btnCancelarValor.BackgroundImage = ByB_SI.My.Resources.CancelarAc
    End Sub

    Private Sub btnCancelarValor_LostFocus(sender As Object, e As EventArgs) Handles btnCancelarValor.LostFocus
        btnCancelarValor.BackgroundImage = ByB_SI.My.Resources.CancelarIn
    End Sub

    Private Sub btnCancelarValor_MouseEnter(sender As Object, e As EventArgs) Handles btnCancelarValor.MouseEnter
        btnCancelarValor.BackgroundImage = ByB_SI.My.Resources.CancelarAc
    End Sub

    Private Sub btnCancelarValor_MouseLeave(sender As Object, e As EventArgs) Handles btnCancelarValor.MouseLeave
        btnCancelarValor.BackgroundImage = ByB_SI.My.Resources.CancelarIn
    End Sub

    Private Sub btnValEnCartera_GotFocus(sender As Object, e As EventArgs) Handles btnValEnCartera.GotFocus
        btnValEnCartera.BackgroundImage = ByB_SI.My.Resources.ChequesAc
    End Sub

    Private Sub btnValEnCartera_LostFocus(sender As Object, e As EventArgs) Handles btnValEnCartera.LostFocus
        btnValEnCartera.BackgroundImage = ByB_SI.My.Resources.ChequesIn
    End Sub

    Private Sub btnValEnCartera_MouseEnter(sender As Object, e As EventArgs) Handles btnValEnCartera.MouseEnter
        btnValEnCartera.BackgroundImage = ByB_SI.My.Resources.ChequesAc
    End Sub

    Private Sub btnValEnCartera_MouseLeave(sender As Object, e As EventArgs) Handles btnValEnCartera.MouseLeave
        btnValEnCartera.BackgroundImage = ByB_SI.My.Resources.ChequesIn
    End Sub

    Private Sub btnSalir_Click(sender As Object, e As EventArgs) Handles btnSalir.Click
        Dim _Elim As New GrabaDatos
        If dgvBufDetalle.RowCount <> 0 Then
            Dim resP As DialogResult
            resP = MessageBox.Show("Salir y vaciar contenido del detalle de valores ?", "Servico de Alertas", MessageBoxButtons.OKCancel, MessageBoxIcon.Question)

            If resP = Windows.Forms.DialogResult.OK Then
                _Elim.Grabar("Factura Venta", "NoImagen", "vaciaDetalleCaja")
                gbxDatos.Enabled = False
                btnNuevo.Enabled = True
                btnCancelar.Enabled = False
                btnGuardar.Enabled = False
                btnNuevo.Select()
                Limpiar()
                Me.Hide()
            End If
        Else
            gbxDatos.Enabled = False
            btnNuevo.Enabled = True
            btnCancelar.Enabled = False
            btnGuardar.Enabled = False
            btnNuevo.Select()
            Limpiar()
            Me.Hide()
        End If
    End Sub

    Private Sub txtIdProv_KeyPress(sender As Object, e As KeyPressEventArgs) Handles txtIdProv.KeyPress
        If Asc(e.KeyChar) = Keys.Enter Then
            If txtIdProv.Text = "" Then
                e.Handled = True
                frmProveedores.lblOrigen.Text = "Recibo Proveedor"
                frmProveedores.txtBuscar.Text = ""
                frmProveedores.txtBuscar.Select()
                frmProveedores.ShowDialog()
            Else
                e.Handled = True
                If IsNumeric(txtIdProv.Text) Then
                    If CDbl(txtIdProv.Text) = 0 Then
                        txtProveedor.Select()
                    Else
                        Dim _Ver As New Mostrar
                        Dim _Ds As New DataSet
                        _Ds.Tables.Add(_Ver.verProveedores(mdifrmppal.cdEmp).Copy)
                        Dim _Dv As New DataView(_Ds.Tables(0))
                        _Dv.RowFilter = "IdProveedores = " & CInt(txtIdProv.Text)
                        If _Dv.Count <> 0 Then
                            dgvProveedor.DataSource = _Dv
                            dgvProveedor.Select()
                            txtProveedor.Text = dgvProveedor.SelectedCells.Item(4).Value
                            txtImporte.SelectionLength = Len(txtImporte.Text)
                            txtImporte.Select()
                        Else
                            MsgBox("Error: Nro de Cuenta no se corresponde con ningún proveedor !", vbInformation, "Servicio de Alertas")
                            txtProveedor.Text = ""
                            txtIdProv.Text = ""
                            txtIdProv.Select()
                        End If
                    End If
                End If
            End If
        End If
    End Sub

    Private Sub btnNuevo_Click(sender As Object, e As EventArgs) Handles btnNuevo.Click
        gbxDatos.Enabled = True
        gbxDetalle.Enabled = True
        Limpiar()
        txtCdEmp.Text = mdifrmppal.cdEmp
        txtFecAlta.Text = Date.Now.Date
        txtHora.Text = Date.Now.ToString("HH:mm:ss")
        txtImporte.Text = Format(0, "$ #,##0.00")
        txtImpValor.Text = Format(0, "$ #,##0.00")
        btnNuevo.Enabled = False
        btnCancelar.Enabled = True
        btnGuardar.Enabled = True
        cbxTipoMov.Select()
        lblFuncion.Text = "Nuevo"
        lblFunValor.Text = "Nuevo"
    End Sub

    Private Sub Limpiar()
        txtCdEmp.Text = ""
        txtFecAlta.Text = ""
        txtHora.Text = ""
        cbxTipoMov.Text = ""
        txtIdProv.Text = ""
        txtProveedor.Text = ""
        txtDetalle.Text = ""
        txtObserv.Text = ""
        txtValNum.Text = ""
        cbxTipoValor.Text = ""
        cbxBanco.Text = ""
        txtSucursal.Text = ""
        txtFecCobro.Text = ""
        txtImpValor.Text = ""
        txtObsValor.Text = ""
        txtValNum.Text = ""
        cbxTipoValor.Text = ""
        cbxBanco.Text = ""
        txtSucursal.Text = ""
        txtLibrador.Text = ""
        txtFecCobro.Text = ""
        txtObsValor.Text = ""
        txtImporte.Text = Format(0, "$ #,##0.00")
        txtImpValor.Text = Format(0, "$ #,##0.00")
        txtTotVal.Text = Format(0, "$ #,##0.00")
    End Sub

    Private Sub LimpiarValor()
        txtValNum.Text = ""
        cbxTipoValor.Text = ""
        cbxBanco.Text = ""
        txtSucursal.Text = ""
        txtLibrador.Text = ""
        txtImpValor.Text = Format(0, "$ #,##0.00")
        txtFecCobro.Text = ""
        txtObsValor.Text = ""
        txtValNum.Select()
    End Sub

    Private Sub tmrHora_Tick(sender As Object, e As EventArgs) Handles tmrHora.Tick
        If gbxDatos.Enabled = True Then
            txtHora.Text = Date.Now.ToString("HH:mm:ss")
        End If
    End Sub

    Private Sub btnCancelar_Click(sender As Object, e As EventArgs) Handles btnCancelar.Click
        gbxDatos.Enabled = False
        Limpiar()
        btnNuevo.Enabled = True
        btnCancelar.Enabled = False
        btnGuardar.Enabled = False
        btnNuevo.Select()
    End Sub

    Private Sub cbxTipoMov_KeyPress(sender As Object, e As KeyPressEventArgs) Handles cbxTipoMov.KeyPress
        If Asc(e.KeyChar) = Keys.Enter Then
            e.Handled = True
            txtIdProv.SelectionLength = Len(txtIdProv.Text)
            txtIdProv.Select()
        End If
    End Sub

    Private Sub txtCliente_KeyPress(sender As Object, e As KeyPressEventArgs)
        If Asc(e.KeyChar) = Keys.Enter Then
            e.Handled = True
            txtDetalle.SelectionLength = Len(txtDetalle.Text)
            txtDetalle.Select()
        End If
    End Sub

    Private Sub txtProveedor_KeyPress(sender As Object, e As KeyPressEventArgs) Handles txtProveedor.KeyPress
        If Asc(e.KeyChar) = Keys.Enter Then
            e.Handled = True
            txtDetalle.SelectionLength = Len(txtDetalle.Text)
            txtDetalle.Select()
        End If
    End Sub

    Private Sub txtDetalle_KeyPress(sender As Object, e As KeyPressEventArgs) Handles txtDetalle.KeyPress
        If Asc(e.KeyChar) = Keys.Enter Then
            e.Handled = True
            txtValNum.SelectionLength = Len(txtValNum.Text)
            txtValNum.Select()
        End If
    End Sub

    Private Sub txtImporte_KeyPress(sender As Object, e As KeyPressEventArgs) Handles txtImporte.KeyPress
        If Asc(e.KeyChar) = Keys.Enter Then
            e.Handled = True
            If Not IsNumeric(txtImporte.Text) Then
                txtImporte.Text = Format(0, "$ #,##0.00")
                txtImporte.Select()
            Else
                txtImporte.Text = Format(CDbl(txtImporte.Text), "$ #,##0.00")
                txtObserv.SelectionLength = Len(txtObserv.Text)
                txtObserv.Select()
            End If
        End If
    End Sub

    Private Sub txtObserv_KeyPress(sender As Object, e As KeyPressEventArgs) Handles txtObserv.KeyPress
        If Asc(e.KeyChar) = Keys.Enter Then
            e.Handled = True
            txtDetalle.SelectionLength = Len(txtDetalle.Text)
            txtDetalle.Select()
        End If
    End Sub

    Private Sub cbxTipoValor_KeyPress(sender As Object, e As KeyPressEventArgs) Handles cbxTipoValor.KeyPress
        If Asc(e.KeyChar) = Keys.Enter Then
            e.Handled = True
            cbxBanco.SelectionLength = Len(cbxBanco.Text)
            cbxBanco.Select()
        End If
    End Sub

    Private Sub cbxBanco_KeyPress(sender As Object, e As KeyPressEventArgs) Handles cbxBanco.KeyPress
        If Asc(e.KeyChar) = Keys.Enter Then
            e.Handled = True
            txtSucursal.SelectionLength = Len(txtSucursal.Text)
            txtSucursal.Select()
        End If
    End Sub

    Private Sub txtSucursal_KeyPress(sender As Object, e As KeyPressEventArgs) Handles txtSucursal.KeyPress
        If Asc(e.KeyChar) = Keys.Enter Then
            e.Handled = True
            txtLibrador.SelectionLength = Len(txtLibrador.Text)
            txtLibrador.Select()
        End If
    End Sub

    Private Sub txtFecCobro_KeyPress(sender As Object, e As KeyPressEventArgs) Handles txtFecCobro.KeyPress
        If Asc(e.KeyChar) = Keys.Enter Then
            e.Handled = True
            txtImpValor.SelectionLength = Len(txtImpValor.Text)
            txtImpValor.Select()
        End If
    End Sub

    Private Sub txtFecCobro_Validated(sender As Object, e As EventArgs) Handles txtFecCobro.Validated
        If Not txtFecCobro.Text = "" Then
            If Not IsDate(txtFecCobro.Text) Then
                MsgBox("Error: Formato de Fecha incorrecto.", vbInformation, "Servico de Alertas")
                txtFecCobro.Text = ""
                txtFecCobro.Select()
            Else
                txtFecCobro.Text = Format(CDate(txtFecCobro.Text), "dd/MM/yyyy")
            End If
        End If
    End Sub

    Private Sub txtImpValor_KeyPress(sender As Object, e As KeyPressEventArgs) Handles txtImpValor.KeyPress
        If Asc(e.KeyChar) = Keys.Enter Then
            e.Handled = True
            If Not IsNumeric(txtImporte.Text) Then
                txtImpValor.Text = Format(0, "$ #,##0.00")
                txtImpValor.Select()
            Else
                Dim totImp As Double
                totImp = CDbl(txtTotVal.Text) + CDbl(txtImpValor.Text)
                If totImp > CDbl(txtImporte.Text) Then
                    MsgBox("Error: El importe Total de valores cargados es mayor que el importe declarado en el Pago a Proveedores !", vbInformation, "Servico de Alertas")
                    txtImpValor.Text = Format(0, "$ #,##0.00")
                    txtImpValor.SelectionLength = Len(txtImpValor.Text)
                    txtImpValor.Select()
                Else
                    txtImpValor.Text = Format(CDbl(txtImpValor.Text), "$ #,##0.00")
                    txtObsValor.SelectionLength = Len(txtObsValor.Text)
                    txtObsValor.Select()
                End If
            End If
        End If
    End Sub

    Private Sub txtObsValor_KeyPress(sender As Object, e As KeyPressEventArgs) Handles txtObsValor.KeyPress
        If Asc(e.KeyChar) = Keys.Enter Then
            e.Handled = True
            btnCargarValor.Select()
        End If
    End Sub

    Private Sub txtValNum_KeyPress(sender As Object, e As KeyPressEventArgs) Handles txtValNum.KeyPress
        If Asc(e.KeyChar) = Keys.Enter Then
            e.Handled = True
            cbxTipoValor.SelectionLength = Len(cbxTipoValor.Text)
            cbxTipoValor.Select()
        End If
    End Sub

    Private Sub btnGuardar_Click(sender As Object, e As EventArgs) Handles btnGuardar.Click
        Dim resP As DialogResult
        Dim _Guardar As New GrabaDatos

        If cbxTipoMov.Text = "" Then
            MsgBox("Error: Falta detallar Tipo de Movimiento !", vbInformation, "Servico de Alertas")
            cbxTipoMov.Select()
        Else
            If txtProveedor.Text = "" Then
                MsgBox("Error: No ha especificado un destinatario !", vbInformation, "Servico de Alertas")
                txtProveedor.Select()
            Else
                If txtDetalle.Text = "" Then
                    MsgBox("Error: No hay detalle de movimiento cargado !", vbInformation, "Servico de Alertas")
                    txtDetalle.Select()
                Else
                    If Not CDbl(txtImporte.Text) > 0 Then
                        MsgBox("Error: El importe del movimiento debe ser mayor que cero !", vbInformation, "Servico de Alertas")
                        txtImporte.SelectionLength = Len(txtImporte.Text)
                        txtImporte.Select()
                    Else
                        If dgvBufDetalle.RowCount = 0 Then
                            MsgBox("Error: No hay valores ingresados !", vbInformation, "Servico de Alertas")
                            txtValNum.Select()
                        Else
                            If CDbl(txtImporte.Text) <> CDbl(txtTotVal.Text) Then
                                MsgBox("Error: El importe del movimiento debe coincidir con el importe total de valores cargados !", vbInformation, "Servico de Alertas")
                                txtValNum.Select()
                            Else
                                resP = MessageBox.Show("Registra Orden de Pago a Proveedores ?", "Servico de Alertas", MessageBoxButtons.OKCancel, MessageBoxIcon.Question)

                                If resP = Windows.Forms.DialogResult.OK Then
                                    Try
                                        'CUENTA CORRIENTE COMPRA
                                        Dim cdBar As String
                                        Dim cdCom As String
                                        cdBar = "*" & txtNroRecibo.Text & Mid(txtFecAlta.Text, 1, 2) & Mid(txtFecAlta.Text, 4, 2) & Mid(txtFecAlta.Text, 7, 4) & "*"
                                        cdCom = "00"

                                        'Obtener saldo de Cuenta Corriente de Compra
                                        Dim ulTid As Integer
                                        Dim _VerMax As New Mostrar
                                        Dim _DtMax As New DataTable
                                        Dim saldoCta As Double
                                        _DtMax = _VerMax.verMaxIdCompraCtaCte()
                                        Dim _Row As DataRow = _DtMax.Rows(_DtMax.Rows.Count - 1)
                                        ulTid = _Row("UltimoId")
                                        _DtMax = _VerMax.consCtaCteCompraID(ulTid)
                                        dgvCtaCte.DataSource = _DtMax

                                        saldoCta = CDbl(dgvCtaCte.SelectedCells.Item(10).Value)
                                        saldoCta = saldoCta - CDbl(txtImporte.Text)
                                        Dim nrOrd As String
                                        nrOrd = txtPtoVta.Text & "-" & txtNroRecibo.Text
                                        _Guardar.Grabar("Orden Pago Proveedores", "NoImagen", "insCtaCteCompra", txtCdEmp.Text, cdBar, Format(CDate(txtFecAlta.Text), "yyyy/MM/dd"), _
                                                        "Contado", "OPP", cbxTipoMov.Text, nrOrd, 0, CDbl(txtImporte.Text), saldoCta, mdifrmppal.usSis, txtIdProv.Text)
                                        ulTid += 1

                                        'Grabo Orden Pago Proveedores
                                        cdBar = "*" & txtNroRecibo.Text & txtIdProv.Text & "*"
                                        _Guardar.Grabar("Orden Pago Proveedores", "NoImagen", "insRecCompra", txtCdEmp.Text, cdBar, _
                                                        Format(CDate(txtFecAlta.Text), "yyyy/MM/dd"), nrOrd, cbxTipoMov.Text, _
                                                        CDbl(txtImporte.Text), txtDetalle.Text, txtObserv.Text,
                                                        mdifrmppal.usSis, ulTid)

                                        _DtMax = _VerMax.verMaxIdReciboCompra()
                                        Dim _Row3 As DataRow = _DtMax.Rows(_DtMax.Rows.Count - 1)
                                        ulTid = _Row3("UltimoId")

                                        'Grabo detalle de valores cargados
                                        For Each row As DataGridViewRow In dgvBufDetalle.Rows
                                            _Guardar.Grabar("Detalle Recibo Compra", "NoImagen", "insDetalleRecCompra", row.Cells(2).Value, _
                                                                Val(row.Cells(3).Value), Format(CDate(row.Cells(4).Value), "yyyy/MM/dd"), _
                                                                row.Cells(5).Value, row.Cells(6).Value, row.Cells(7).Value, _
                                                                CDbl(Val(row.Cells(8).Value)), row.Cells(9).Value, ulTid)
                                        Next

                                        'Obtener saldo de caja del día actual
                                        Dim idCj As Integer
                                        Dim saldoCj As Double
                                        _DtMax = _VerMax.verMaxIdCaja()
                                        Dim _Row1 As DataRow = _DtMax.Rows(_DtMax.Rows.Count - 1)
                                        If _Row1("UltimoId").ToString = "" Then
                                            idCj = 0
                                        Else
                                            idCj = _Row1("UltimoId")
                                        End If
                                        _DtMax = _VerMax.verSaldoCajaUltimoId(idCj)
                                        dgvSaldoCaja.DataSource = _DtMax
                                        saldoCj = CDbl(dgvSaldoCaja.SelectedCells.Item(10).Value)
                                        saldoCj = saldoCj - CDbl(txtImporte.Text)

                                        'Grabo Movimiento de Caja
                                        txtSaldoCaja.Text = Format(CDbl(txtSaldoCaja.Text) - CDbl(txtImporte.Text), "$ #,##0.00")
                                        _Guardar.Grabar("Orden Pago Proveedores", "NoImagen", "insCaja", txtCdEmp.Text, Format(CDate(txtFecAlta.Text), "yyyy/MM/dd"), _
                                                       "Egreso", CInt(txtIdProv.Text), txtProveedor.Text, "Orden N° " & txtPtoVta.Text & "-" & txtNroRecibo.Text, _
                                                        0, CDbl(txtImporte.Text), saldoCj, txtObserv.Text, mdifrmppal.usSis)

                                        'Obtener ultimo ID cargado de Caja
                                        _DtMax = _VerMax.verMaxIdCaja()
                                        Dim _Row2 As DataRow = _DtMax.Rows(_DtMax.Rows.Count - 1)
                                        ulTid = _Row2("UltimoId")

                                        Dim enCart As String = ""
                                        For Each row As DataGridViewRow In dgvBufDetalle.Rows
                                            'Grabo Detalle de Movimiento
                                            If row.Cells(2).Value = "Cheque" Then
                                                enCart = "No"
                                            Else
                                                enCart = "--"
                                            End If
                                            _Guardar.Grabar("Orden Pago Proveedor", "NoImagen", "modDetalleCaja", Val(row.Cells(11).Value), enCart)
                                        Next

                                        'ACTUALIZO NUMERO RECIBO
                                        Dim X, _inC, _Dig As Integer
                                        Dim _reSto As String

                                        For X = 1 To 8
                                            If Mid(txtNroRecibo.Text, X, 1) <> "0" Then
                                                _Dig = 9 - X
                                                Exit For
                                            End If
                                        Next
                                        _inC = Mid(txtNroRecibo.Text, 9 - _Dig, _Dig)
                                        _inC = _inC + 1
                                        _Dig = Len(CStr(_inC))
                                        _reSto = Mid(txtNroRecibo.Text, 1, 8 - _Dig)
                                        txtNroRecibo.Text = _reSto & CStr(_inC)
                                        _Guardar.Grabar("Recibo Venta", "NoImagen", "modSistemaNroReciboCompra", txtCdEmp.Text, txtNroRecibo.Text)

                                        'Limpio datagrid y pantalla
                                        Dim _Ver As New Mostrar
                                        Dim _Dt As New DataTable
                                        Dim _Elim As New GrabaDatos
                                        _Elim.Grabar("Detalle Caja", "NoImagen", "vaciaDetalleCaja")
                                        _Dt = _Ver.verDetalleValoresRecVta()
                                        dgvBufDetalle.DataSource = _Dt

                                        _Dt = _Ver.verVAloresEnVartera()
                                        dgvCaja.DataSource = _Dt
                                        dgvCaja.Columns.Item("Eliminar").Visible = False
                                        dgvCaja.Columns.Item("idCajaDetalle").Visible = False
                                        dgvCaja.Columns.Item("EnCartera").Visible = False
                                        dgvCaja.Columns.Item("Observaciones").Visible = False
                                        dgvCaja.Columns.Item("Caja_idCaja").Visible = False

                                        Dim estiloEnc As New DataGridViewCellStyle()
                                        Dim textEnc As String = ""

                                        estiloEnc.Font = New Font(dgvCaja.Font, FontStyle.Bold)
                                        dgvCaja.ColumnHeadersDefaultCellStyle = estiloEnc
                                        dgvCaja.ColumnHeadersDefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleCenter
                                        For X = 1 To 11
                                            If X = 4 Then
                                                dgvCaja.Columns(X).DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight
                                                dgvCaja.Columns(X).DefaultCellStyle.Format = "dd/MM/yyyy"
                                            ElseIf X = 8 Then
                                                dgvCaja.Columns(X).DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight
                                                dgvCaja.Columns(X).DefaultCellStyle.Format = "$ #,##0.00"
                                            Else
                                                dgvCaja.Columns(X).DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleLeft
                                            End If
                                            Select Case X
                                                Case 0
                                                    textEnc = "ELIM"
                                                    dgvCaja.Columns(0).Width = 30
                                                Case 1
                                                    textEnc = "ITEM"
                                                    dgvCaja.Columns(1).Width = 30
                                                Case 2
                                                    textEnc = "VALOR"
                                                    dgvCaja.Columns(2).Width = 100
                                                Case 3
                                                    textEnc = "NUMERO"
                                                    dgvCaja.Columns(3).Width = 100
                                                Case 4
                                                    textEnc = "FEC COBRO"
                                                    dgvCaja.Columns(4).Width = 150
                                                Case 5
                                                    textEnc = "LIBRADOR"
                                                    dgvCaja.Columns(5).Width = 250
                                                Case 6
                                                    textEnc = "BANCO"
                                                    dgvCaja.Columns(6).Width = 150
                                                Case 7
                                                    textEnc = "SUCURSAL"
                                                    dgvCaja.Columns(7).Width = 200
                                                Case 8
                                                    textEnc = "IMPORTE"
                                                    dgvCaja.Columns(8).Width = 100
                                                Case 9
                                                    textEnc = "EN CARTERA"
                                                    dgvCaja.Columns(9).Width = 100
                                                Case 10
                                                    textEnc = "OBSERVACIONES"
                                                    dgvCaja.Columns(10).Width = 100
                                                Case 11
                                                    textEnc = "ID CAJA"
                                                    dgvCaja.Columns(11).Width = 100
                                            End Select
                                            dgvCaja.Columns(X).HeaderText = textEnc
                                        Next

                                        ActualizaTotal()

                                        Limpiar()
                                        gbxDatos.Enabled = False
                                        gbxDetalle.Enabled = False
                                        lblFuncion.Text = "Nuevo"
                                        lblFunValor.Text = "Nuevo"
                                        btnNuevo.Enabled = True
                                        btnGuardar.Enabled = False
                                        btnCancelar.Enabled = False
                                        txtIdProv.Enabled = True
                                        txtProveedor.Enabled = True
                                        btnNuevo.Select()
                                    Catch ex As MySqlException
                                        MsgBox("Error: Orden de Pago No fue Registrada correctamente !" & vbCrLf & vbCrLf & ex.ToString, vbCritical, "Servicio de Alertas")
                                    End Try
                                End If
                            End If
                        End If
                    End If
                End If
            End If
        End If
    End Sub

    Private Sub btnCargarValor_Click(sender As Object, e As EventArgs) Handles btnCargarValor.Click
        Dim _Guardar As New GrabaDatos

        Try
            If cbxTipoValor.Text = "" Then
                MsgBox("Error: Seleccione un Tipo de Valor !", vbInformation, "Servico de Alertas")
                cbxTipoValor.Select()
            Else
                If Not (cbxTipoValor.Text = "Efectivo" Or cbxTipoValor.Text = "Cheque" Or cbxTipoValor.Text = "Tarjeta Crédito" Or cbxTipoValor.Text = "Tarjeta Débito" Or cbxTipoValor.Text = "Otros") Then
                    MsgBox("Error: El Tipo de Valor No es válido!", vbInformation, "Servico de Alertas")
                    cbxTipoValor.Select()
                Else
                    Dim totImp As Double
                    totImp = CDbl(txtTotVal.Text) + CDbl(txtImpValor.Text)
                    If totImp > CDbl(txtImporte.Text) Then
                        MsgBox("Error: El importe Total de valores cargados es mayor que el importe declarado en el Pago a Proveedores !", vbInformation, "Servico de Alertas")
                        txtImpValor.Text = Format(0, "$ #,##0.00")
                        txtImpValor.SelectionLength = Len(txtImpValor.Text)
                        txtImpValor.Select()
                    Else
                        If cbxTipoValor.Text <> "Efectivo" Then
                            If txtValNum.Text = "" Or cbxBanco.Text = "" Or txtSucursal.Text = "" Or txtLibrador.Text = "" Or txtFecCobro.Text = "" Or CDbl(txtImpValor.Text) = 0 Then
                                MsgBox("Error: Todos los campos (menos Observaciones) son obligatorios, importe no pude ser cero !", vbInformation, "Servico de Alertas")
                            Else
                                If lblidDetCaja.Text = "" Then
                                    lblidDetCaja.Text = "-99"
                                End If
                                If lblFunValor.Text = "Nuevo" Then
                                    _Guardar.Grabar("Caja", "NoImagen", "insBufferDetalleCaja", cbxTipoValor.Text, txtValNum.Text, _
                                                    Format(CDate(txtFecCobro.Text), "yyyy/MM/dd"), txtLibrador.Text, cbxBanco.Text, _
                                                    txtSucursal.Text, CDbl(txtImpValor.Text), "Si", txtObsValor.Text, CInt(lblidDetCaja.Text))
                                Else
                                    _Guardar.Grabar("Caja", "NoImagen", "modBufferDetalleCaja", lblidDetCaja.Text, cbxTipoValor.Text, txtValNum.Text, _
                                                    Format(CDate(txtFecCobro.Text), "yyyy/MM/dd"), txtLibrador.Text, cbxBanco.Text, _
                                                    txtSucursal.Text, CDbl(txtImpValor.Text), "Si", txtObsValor.Text, CInt(lblidDetCaja.Text))
                                End If
                                LimpiarValor()
                                ActualizaTotal()
                                lblFunValor.Text = "Nuevo"
                                txtValNum.Select()
                            End If
                        Else
                            If CDbl(txtImpValor.Text) = 0 Then
                                MsgBox("Error: El importe NO puede ser cero !", vbInformation, "Servico de Alertas")
                                txtImpValor.Select()
                            Else
                                If txtObsValor.Text = "" Then
                                    txtObsValor.Text = "-"
                                End If

                                If lblFunValor.Text = "Nuevo" Then
                                    _Guardar.Grabar("Caja", "NoImagen", "insBufferDetalleCaja", cbxTipoValor.Text, "-99", _
                                                    Format(Date.Now.Date, "yyyy/MM/dd"), "-", "-", _
                                                    "-", CDbl(txtImpValor.Text), "Si", txtObsValor.Text, -99)
                                Else
                                    _Guardar.Grabar("Caja", "NoImagen", "modBufferDetalleCaja", lblidDetCaja.Text, cbxTipoValor.Text, "-99", _
                                                    Format(Date.Now.Date, "yyyy/MM/dd"), "-", "-", _
                                                    "-", CDbl(txtImpValor.Text), "Si", txtObsValor.Text, -99)
                                End If
                                LimpiarValor()
                                ActualizaTotal()
                                lblFunValor.Text = "Nuevo"
                                txtValNum.Select()
                            End If
                        End If

                        Dim _Dt As New DataTable
                        Dim _Ver As New Mostrar
                        _Dt = _Ver.verDetalleValoresCaja()
                        dgvBufDetalle.DataSource = _Dt
                        dgvBufDetalle.Columns.Item("EnCartera").Visible = False
                        dgvBufDetalle.Columns.Item("Observaciones").Visible = False

                        Dim estiloEnc As New DataGridViewCellStyle()
                        Dim textEnc As String = ""
                        Dim X As Integer

                        estiloEnc.Font = New Font(dgvBufDetalle.Font, FontStyle.Bold)
                        dgvBufDetalle.ColumnHeadersDefaultCellStyle = estiloEnc
                        dgvBufDetalle.ColumnHeadersDefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleCenter
                        For X = 1 To 10
                            If X = 1 Or X = 9 Then
                                dgvBufDetalle.Columns(X).DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleCenter
                            ElseIf X = 4 Then
                                dgvBufDetalle.Columns(X).DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight
                            ElseIf X = 8 Then
                                dgvBufDetalle.Columns(X).DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight
                                dgvBufDetalle.Columns(X).DefaultCellStyle.Format = "$ #,##0.00"
                            Else
                                dgvBufDetalle.Columns(X).DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleLeft
                            End If
                            Select Case X
                                Case 0
                                    textEnc = "ELIM"
                                    dgvBufDetalle.Columns(0).Width = 30
                                Case 1
                                    textEnc = "ITEM"
                                    dgvBufDetalle.Columns(1).Width = 30
                                Case 2
                                    textEnc = "VALOR"
                                    dgvBufDetalle.Columns(2).Width = 100
                                Case 3
                                    textEnc = "NUMERO"
                                    dgvBufDetalle.Columns(3).Width = 100
                                Case 4
                                    textEnc = "FEC COBRO"
                                    dgvBufDetalle.Columns(4).Width = 150
                                Case 5
                                    textEnc = "LIBRADOR"
                                    dgvBufDetalle.Columns(5).Width = 150
                                Case 6
                                    textEnc = "BANCO"
                                    dgvBufDetalle.Columns(6).Width = 100
                                Case 7
                                    textEnc = "SUCURSAL"
                                    dgvBufDetalle.Columns(7).Width = 100
                                Case 8
                                    textEnc = "IMPORTE"
                                    dgvBufDetalle.Columns(8).Width = 70
                                Case 9
                                    textEnc = "EN CARTERA"
                                    dgvBufDetalle.Columns(9).Width = 100
                                Case 10
                                    textEnc = "OBSERVACIONES"
                                    dgvBufDetalle.Columns(9).Width = 100
                            End Select
                            dgvBufDetalle.Columns(X).HeaderText = textEnc
                        Next
                    End If
                End If
            End If
        Catch ex As MySqlException
            MsgBox("Error: Tabla Detalle no fue modificada !" & vbCrLf & vbCrLf & ex.ToString, vbCritical, "Servicio de Alertas")
            BDxxx()
        Finally
            BDxxx()
        End Try

    End Sub

    Private Sub frmCaja_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Try
            Dim _Ver, _Ver1 As New Mostrar
            Dim _Dt, _Dt1, _Dt2 As New DataTable
            Dim _Elim As New GrabaDatos

            'BUFFER DETALLE DE VALORES CARGADOS
            _Dt = _Ver.verDetalleValoresCaja()
            dgvBufDetalle.DataSource = _Dt
            dgvBufDetalle.Columns.Item("EnCartera").Visible = False
            dgvBufDetalle.Columns.Item("Observaciones").Visible = False

            Dim estiloEnc As New DataGridViewCellStyle()
            Dim textEnc As String = ""
            Dim X As Integer

            estiloEnc.Font = New Font(dgvBufDetalle.Font, FontStyle.Bold)
            dgvBufDetalle.ColumnHeadersDefaultCellStyle = estiloEnc
            dgvBufDetalle.ColumnHeadersDefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleCenter
            For X = 1 To 10
                If X = 1 Or X = 9 Then
                    dgvBufDetalle.Columns(X).DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleCenter
                ElseIf X = 4 Then
                    dgvBufDetalle.Columns(X).DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight
                ElseIf X = 8 Then
                    dgvBufDetalle.Columns(X).DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight
                    dgvBufDetalle.Columns(X).DefaultCellStyle.Format = "$ #,##0.00"
                Else
                    dgvBufDetalle.Columns(X).DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleLeft
                End If
                Select Case X
                    Case 0
                        textEnc = "ELIM"
                        dgvBufDetalle.Columns(0).Width = 30
                    Case 1
                        textEnc = "ITEM"
                        dgvBufDetalle.Columns(1).Width = 30
                    Case 2
                        textEnc = "VALOR"
                        dgvBufDetalle.Columns(2).Width = 100
                    Case 3
                        textEnc = "NUMERO"
                        dgvBufDetalle.Columns(3).Width = 100
                    Case 4
                        textEnc = "FEC COBRO"
                        dgvBufDetalle.Columns(4).Width = 150
                    Case 5
                        textEnc = "LIBRADOR"
                        dgvBufDetalle.Columns(5).Width = 150
                    Case 6
                        textEnc = "BANCO"
                        dgvBufDetalle.Columns(6).Width = 100
                    Case 7
                        textEnc = "SUCURSAL"
                        dgvBufDetalle.Columns(7).Width = 100
                    Case 8
                        textEnc = "IMPORTE"
                        dgvBufDetalle.Columns(8).Width = 70
                    Case 9
                        textEnc = "EN CARTERA"
                        dgvBufDetalle.Columns(9).Width = 100
                    Case 10
                        textEnc = "OBSERVACIONES"
                        dgvBufDetalle.Columns(9).Width = 100
                End Select
                dgvBufDetalle.Columns(X).HeaderText = textEnc
            Next

            _Dt1 = _Ver.verSistema(mdifrmppal.cdEmp)
            Dim _Row As DataRow = _Dt1.Rows(_Dt1.Rows.Count - 1)
            txtNroRecibo.Text = CStr(_Row("NroOrdenPago"))
            txtPtoVta.Text = CStr(_Row("PtoVta"))

            Me.Text = "EMISION DE ORDENES DE PAGO A PROVEEDORES - " & mdifrmppal.encForm
            txtCdEmp.Text = mdifrmppal.cdEmp
            lblFunValor.Text = "Nuevo"
            txtImporte.Text = Format(0, "$ #,##0.00")
            txtImpValor.Text = Format(0, "$ #,##0.00")

            ActualizaTotal()

            btnNuevo.Select()
        Catch ex As Exception
            MsgBox("Error: Valores en cartera no pueden cargarse !", vbInformation, "Servicio de Alertas")
        End Try
    End Sub

    Private Sub txtLibrador_KeyPress(sender As Object, e As KeyPressEventArgs) Handles txtLibrador.KeyPress
        If Asc(e.KeyChar) = Keys.Enter Then
            e.Handled = True
            txtFecCobro.SelectionLength = Len(txtFecCobro.Text)
            txtFecCobro.Select()
        End If
    End Sub

    Private Sub ActualizaTotal()
        'Actualizo el DataGridView y sumo valores
        Dim _Ver As New Mostrar
        Dim _Dt As New DataTable
        Dim TotalValores As Double

        _Dt = _Ver.verVAloresEnVartera()
        dgvCaja.DataSource = _Dt
        For Each row As DataGridViewRow In dgvCaja.Rows
            TotalValores += Val(row.Cells(8).Value)
        Next
        txtSaldoCaja.Text = Format(TotalValores, "$ #,##0.00")

        TotalValores = 0
        _Dt = _Ver.verDetalleValoresCaja()
        dgvBufDetalle.DataSource = _Dt
        For Each row As DataGridViewRow In dgvBufDetalle.Rows
            TotalValores += Val(row.Cells(8).Value)
        Next
        txtTotVal.Text = Format(TotalValores, "$ #,##0.00")
    End Sub

    Private Sub btnModValor_Click(sender As Object, e As EventArgs) Handles btnModValor.Click
        Try
            If dgvBufDetalle.RowCount <> 0 Then
                lblFunValor.Text = "Modificar"
                lblidDetCaja.Text = dgvBufDetalle.SelectedCells.Item(1).Value
                txtValNum.Text = dgvBufDetalle.SelectedCells.Item(3).Value
                cbxTipoValor.Text = dgvBufDetalle.SelectedCells.Item(2).Value
                cbxBanco.Text = dgvBufDetalle.SelectedCells.Item(6).Value
                txtSucursal.Text = dgvBufDetalle.SelectedCells.Item(7).Value
                txtLibrador.Text = dgvBufDetalle.SelectedCells.Item(5).Value
                txtFecCobro.Text = Format(CDate(dgvBufDetalle.SelectedCells.Item(4).Value), "dd/MM/yyyy")
                txtImpValor.Text = Format(CDbl(dgvBufDetalle.SelectedCells.Item(8).Value), "$ #,##0.00")
                txtObsValor.Text = dgvBufDetalle.SelectedCells.Item(10).Value
                txtValNum.SelectionLength = Len(txtValNum.Text)
                txtValNum.Select()
            End If
        Catch ex As Exception
            MsgBox("Error: No se pueden cargar los datos para modificar !" & vbCrLf & vbCrLf & ex.ToString, vbExclamation, "Servicio de Alertas")
            btnModValor.Select()
        End Try
    End Sub

    Private Sub btnCancelarValor_Click(sender As Object, e As EventArgs) Handles btnCancelarValor.Click
        LimpiarValor()
        txtValNum.Select()
    End Sub

    Private Sub dgvBufDetalle_CellContentClick(sender As Object, e As DataGridViewCellEventArgs) Handles dgvBufDetalle.CellContentClick
        If e.ColumnIndex = Me.dgvBufDetalle.Columns.Item("ElimBuff").Index Then
            Dim celSel As DataGridViewCheckBoxCell = Me.dgvBufDetalle.Rows(e.RowIndex).Cells("ElimBuff")
            celSel.Value = Not celSel.Value
        End If
    End Sub

    Private Sub btnEliminarValor_Click(sender As Object, e As EventArgs) Handles btnEliminarValor.Click
        Dim resP As DialogResult
        Dim _Elim As New GrabaDatos

        resP = MessageBox.Show("Elimar Items Selcionados!?", "Servico de Alertas", MessageBoxButtons.OKCancel, MessageBoxIcon.Question)

        If resP = Windows.Forms.DialogResult.OK Then
            Try
                For Each row As DataGridViewRow In dgvBufDetalle.Rows
                    Dim seL As Boolean = Convert.ToBoolean(row.Cells("ElimBuff").Value)

                    If seL = True Then
                        Dim clElim As Integer = Convert.ToInt32(row.Cells("IdBufferCajaDetalle").Value)
                        _Elim.Grabar("Caja", "NoImagen", "eliBuffDetalleCaja", clElim)
                    End If
                Next

                ActualizaTotal()
                LimpiarValor()
                txtValNum.Select()
            Catch ex As MySqlException
                MsgBox("Error al Eliminar Items de Valores !" & vbCrLf & vbCrLf & ex.ToString, vbCritical, "Servicio de Alertas")
            End Try
        End If
    End Sub

    Private Sub btnValEnCartera_Click(sender As Object, e As EventArgs) Handles btnValEnCartera.Click
        If cbxTipoMov.Text = "Ingreso" Then
            MsgBox("Error: No puede seleccionar valores si elige Ingreso en 'Tipo Movimiento' !", vbInformation, "Servicio de Alertas")
            cbxTipoMov.SelectionLength = Len(cbxTipoMov.Text)
            cbxTipoMov.Select()
        Else
            frmChqEnCartera.lblOrigen.Text = "Orden Pago Proveedor"
            frmChqEnCartera.ShowDialog()
        End If
    End Sub

    Private Sub txtImporte_Validated(sender As Object, e As EventArgs) Handles txtImporte.Validated
        If Not IsNumeric(txtImporte.Text) Then
            txtImporte.Text = Format(0, "$ #,##0.00")
            txtImporte.Select()
        Else
            txtImporte.Text = Format(CDbl(txtImporte.Text), "$ #,##0.00")
            txtObserv.SelectionLength = Len(txtObserv.Text)
            txtObserv.Select()
        End If
    End Sub


    Private Sub dgvCaja_DoubleClick(sender As Object, e As EventArgs) Handles dgvCaja.DoubleClick
        Try
            If gbxDatos.Enabled = True Then
                If dgvCaja.RowCount <> 0 Then
                    lblFunValor.Text = "Nuevo"
                    lblidDetCaja.Text = dgvCaja.SelectedCells.Item(1).Value
                    txtValNum.Text = dgvCaja.SelectedCells.Item(3).Value
                    cbxTipoValor.Text = dgvCaja.SelectedCells.Item(2).Value
                    cbxBanco.Text = dgvCaja.SelectedCells.Item(6).Value
                    txtSucursal.Text = dgvCaja.SelectedCells.Item(7).Value
                    txtLibrador.Text = dgvCaja.SelectedCells.Item(5).Value
                    txtFecCobro.Text = Format(CDate(dgvCaja.SelectedCells.Item(4).Value), "dd/MM/yyyy")
                    txtImpValor.Text = Format(CDbl(dgvCaja.SelectedCells.Item(8).Value), "$ #,##0.00")
                    txtObsValor.Text = dgvCaja.SelectedCells.Item(10).Value
                    txtValNum.SelectionLength = Len(txtValNum.Text)
                    txtValNum.Select()
                End If
            End If
        Catch ex As Exception
            MsgBox("Error: No se pueden cargar los datos seleccionados !" & vbCrLf & vbCrLf & ex.ToString, vbExclamation, "Servicio de Alertas")
            btnModValor.Select()
        End Try

    End Sub

End Class